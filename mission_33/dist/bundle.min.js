!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function Board(w,h){this.width=w,this.height=h}var Pointer=require("./Pointer"),util=require("./util");Board.prototype={createBoardView:function(id,bgImg){var boardView=util.createEle("div",{id:id,style:{width:util.getUnit(this.width),height:util.getUnit(this.height),backgroundImage:bgImg}});return util.append(boardView,this.robotView,"left-bottom",this.robot.pointer.x,this.robot.pointer.y),boardView},drawRobot:function(robot){robot.setBoundary(Pointer.ORIGIN,new Pointer(this.width-1,this.height-1)),robot.setView("robot","./img/bug.png"),this.robot=robot}},util.defineConstructor(Board),module.exports=Board},{"./Pointer":4,"./util":7}],2:[function(require,module,exports){function Boundry(start,end){start instanceof Pointer||(this.start=Pointer.ORIGIN),this.start=start,end instanceof Pointer||(this.start=Pointer.ORIGIN),this.end=end}var Pointer=require("./Pointer"),util=require("./util");Boundry.prototype={getMinX:function(){return this.start.x<this.end.x?this.start.x:this.end.x},getMinY:function(){return this.start.y<this.end.y?this.start.y:this.end.y},getMaxX:function(){return this.start.x>this.end.x?this.start.x:this.end.x},getMaxY:function(){return this.start.y>this.end.y?this.start.y:this.end.y}},util.defineConstructor(Boundry),module.exports=Boundry},{"./Pointer":4,"./util":7}],3:[function(require,module,exports){function Direction(angle){this.angle=util.cycle(angle)}var util=require("./util"),Pointer=require("./Pointer");Direction.EAST=new Direction(0),Direction.NORTH=new Direction(90),Direction.WEST=new Direction(180),Direction.SOUTH=new Direction(270),Direction.prototype={getX:function(){return Math.cos(this.getRadian())},getY:function(){return Math.sin(this.getRadian())},getVector:function(){return new Pointer(this.getX(),this.getY())},getRadian:function(){return this.angle/180*Math.PI},addAngle:function(a){return new Direction(this.angle+a)},clone:function(){return new Direction(this.angle)},forCSSRotation:function(){return util.cycle(90-this.angle)},toString:function(){return this.angle}},util.defineConstructor(Direction),module.exports=Direction},{"./Pointer":4,"./util":7}],4:[function(require,module,exports){function Pointer(x,y){this.x=x,this.y=y}var util=require("./util");Pointer.ORIGIN=new Pointer(0,0),Pointer.prototype={multiply:function(multiple){return new Pointer(this.x*multiple,this.y*multiple)},add:function(pointer){return new Pointer(this.x+pointer.x,this.y+pointer.y)},normalize:function(boundary){this.x=util.limit(this.x,boundary.getMinX(),boundary.getMaxX()),this.y=util.limit(this.y,boundary.getMinY(),boundary.getMaxY())},clone:function(){return new Pointer(this.x,this.y)},toString:function(){return"("+this.x+", "+this.y+")"}},util.defineConstructor(Pointer),module.exports=Pointer},{"./util":7}],5:[function(require,module,exports){function Robot(direction,pointer,runningSpeed,rotatingSpeed){direction instanceof Direction?this.direction=direction:this.direction=Direction.EAST,pointer instanceof Pointer?this.pointer=pointer:this.pointer=Pointer.ORIGIN,runningSpeed?this.runningSpeed=runningSpeed:this.runningSpeed=.002,rotatingSpeed?this.rotatingSpeed=rotatingSpeed:this.rotatingSpeed=.36}var Pointer=require("./Pointer"),Direction=require("./Direction"),Boundary=require("./Boundary"),util=require("./util"),cm=new Map;cm.set(/^go(\s)+(-)?(\d)*$/i,Robot.prototype.go),cm.set(/^back(\s)+(-)?(\d)*$/i,Robot.prototype.back),cm.set(/^turn(\s)+(-)?(\d)*/i,Robot.prototype.turn),cm.set(/^turn(\s)*l(eft)?$/i,Robot.prototype.turnLeft),cm.set(/^turn(\s)*r(ight)?$/i,Robot.prototype.turnRight),cm.set(/^turn(\s)*b(ack)?$/i,Robot.prototype.turnBack),Robot.CmdMap=cm,Robot.prototype={go:function(step){step>0?this.updatePointerView(this.pointer.clone(),Math.abs(step)/this.runningSpeed,1):0>step&&this.back(-step)},back:function(step){step>0?this.updatePointerView(this.pointer.clone(),Math.abs(step)/this.runningSpeed,-1):0>step&&this.go(-step)},turn:function(){"number"==typeof arguments[0]?arguments[0]>0?this.updateDirectionView(this.direction.clone(),Math.abs(arguments[0])/this.rotatingSpeed,1):arguments[0]<0&&this.updateDirectionView(this.direction.clone(),Math.abs(arguments[0])/this.rotatingSpeed,-1):"string"==typeof arguments[0]&&"number"==typeof arguments[1]},turnRight:function(){this.turn(-90)},turnLeft:function(){this.turn(90)},turnBack:function(){this.turn(180)},setView:function(id,imgSrc){var robotView=util.createEle("img",{id:id,className:"robotView",src:imgSrc,width:util.getUnit(1),height:util.getUnit(1)});this.view=robotView},updatePointerView:function(fromPointer,time,isPositive){function move(timestamp){start||(start=timestamp);var progress=(timestamp-start).toFixed();that.pointer=fromPointer.add(that.direction.getVector().multiply(isPositive*progress*that.runningSpeed)),that.pointer.normalize(that.boundary),that.view.style.left=util.getUnit(that.pointer.x),that.view.style.bottom=util.getUnit(that.pointer.y),time>progress&&window.requestAnimationFrame(arguments.callee)}var start=null,that=this;window.requestAnimationFrame(move)},updateDirectionView:function(fromDirection,time,isPositive){function rotate(timestamp){start||(start=timestamp);var progress=(timestamp-start).toFixed();that.direction=fromDirection.addAngle(Math.round(isPositive*progress*that.rotatingSpeed)),that.view.style.transform="rotate("+that.direction.forCSSRotation()+"deg)",time>progress&&window.requestAnimationFrame(arguments.callee)}var start=null,that=this;window.requestAnimationFrame(rotate)},setBoundary:function(startPoint,endPoint){this.boundary=new Boundary(startPoint,endPoint)},getCmdMap:function(){return Robot.CmdMap}},util.defineConstructor(Robot),module.exports=Robot},{"./Boundary":2,"./Direction":3,"./Pointer":4,"./util":7}],6:[function(require,module,exports){function clickHandler(e){}function keyHandler(e){}var Board=require("./Board"),Robot=require("./Robot"),Direction=require("./Direction"),Pointer=require("./Pointer"),util=require("./util"),board=new Board(10,10),robot=new Robot(new Direction(90),new Pointer(3,4));board.drawRobot(robot),util.append(document.body,board.createBoardView("board",'url("../img/bg.png")'),"left-top",10,10,!0),util.append(document.body,util.createEle("button",{id:"go",className:"btn go",onclick:clickHandler},"go"),"left-bottom",10,40,!0),util.append(document.body,util.createEle("button",{id:"back",className:"btn back",onclick:clickHandler},"back"),"left-bottom",100,40,!0),util.append(document.body,util.createEle("button",{id:"turnLeft",className:"btn turnLeft",onclick:clickHandler},"turnLeft"),"left-bottom",10,10,!0),util.append(document.body,util.createEle("button",{id:"turnRight",className:"btn turnRight",onclick:clickHandler},"turnRight"),"left-bottom",100,10,!0),util.append(document.body,util.createEle("button",{id:"turnBack",className:"btn turnBack",onclick:clickHandler},"turnBack"),"left-bottom",190,10,!0),util.append(document.body,util.createEle("div",{id:"logger",className:"logger",style:{width:"300px",height:"800px"}}),"right-top",10,10,!0),util.append(document.body,util.createEle("textarea",{id:"cmdarea",className:"cmdarea",placeholder:"请输入要执行的命令",cols:30,rows:5,autofocus:"autofocus",onkeyup:keyHandler}),"left-bottom",10,100,!0),util.getEle("go").addEventListener("click",function(e){robot.go(1),util.log(util.getEle("logger"),"robot go 1","red")}),util.getEle("back").addEventListener("click",function(e){robot.back(1),util.log(util.getEle("logger"),"robot back 1","red")}),util.getEle("turnLeft").addEventListener("click",function(e){robot.turnLeft(),util.log(util.getEle("logger"),"robot turn left","orange")}),util.getEle("turnRight").addEventListener("click",function(e){robot.turnRight(),util.log(util.getEle("logger"),"robot turn right","orange")}),util.getEle("turnBack").addEventListener("click",function(e){robot.turnBack(),util.log(util.getEle("logger"),"robot turn back","orange")})},{"./Board":1,"./Direction":3,"./Pointer":4,"./Robot":5,"./util":7}],7:[function(require,module,exports){var util={defineConstructor:function(ClassObject){Object.defineProperty(ClassObject.prototype,"constructor",{value:ClassObject,enumerable:!1})},createEle:function(name,attrs,text){var ele=document.createElement(name);if(attrs)for(var key in attrs)ele[key]=attrs[key];return text&&ele.appendChild(document.createTextNode(text)),ele},append:function(container,child,type,x,y,isPX){var refer=type.split("-");refer.length>0&&(child.style.position="absolute",isPX?(child.style[refer[0]]=x,child.style[refer[1]]=y):(child.style[refer[0]]=this.getUnit(x),child.style[refer[1]]=this.getUnit(y))),container.appendChild(child)},getEle:function(id){return document.getElementById(id)},cycle:function(angle){return angle>=0?angle%360:360- -angle%360},getUnit:function(x,unit){return unit||(unit=this.defaultValues.unit),x*unit+"px"},limit:function(value,valueMin,valueMax){return valueMin>value?valueMin:value>valueMax?valueMax:value},trim:function(str){return String.prototype.trim?str.trim():str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},log:function(container,str,color){var timeP=this.createEle("p",null,"logTime",null,(new Date).toLocaleString()),logP=this.createEle("p",null,null,null,str);color&&(logP.style.color=color),logP.style.marginBottom="0.5em",container.appendChild(timeP),container.appendChild(logP)},defaultValues:{unit:50,step:1,angle:90}};module.exports=util},{}]},{},[6]);